<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>資產複利增長預測計算器</title>
<style>
  body {
    font-family: "Microsoft JhengHei", "Arial", sans-serif;
    background: #E0F7FA;
    margin: 0;
    padding: 20px;
  }
  .container {
    max-width: 800px;
    margin: 0 auto;
    background: #80DEEA;
    border-radius: 10px;
    padding: 20px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.2);
  }
  h1 {
    text-align: center;
    color: #006064;
    margin-bottom: 30px;
  }
  .input-group {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    margin-bottom: 30px;
  }
  .form-item {
    flex: 1;
    min-width: 280px;
  }
  label {
    display: block;
    margin-bottom: 8px;
    font-weight: bold;
    color: #004D40;
  }
  input {
    width: 100%;
    padding: 12px;
    border: 2px solid #00ACC1;
    border-radius: 6px;
    font-size: 16px;
  }
  button {
    background: #FF5722;
    color: white;
    border: none;
    padding: 14px 30px;
    font-size: 18px;
    border-radius: 6px;
    cursor: pointer;
    display: block;
    margin: 20px auto;
  }
  button:hover { background: #E64A19; }
  #result {
    text-align: center;
    font-size: 24px;
    font-weight: bold;
    color: #1B5E20;
    margin: 20px 0;
  }
  canvas {
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  }
</style>
<!-- 引入 Chart.js 繪製折線圖 -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
<div class="container">
  <h1>資產預測計算器</h1>
  
  <div class="input-group">
    <div class="form-item">
      <label>當前資產（元）</label>
      <input type="number" id="initial" value="100000" min="0">
    </div>
    <div class="form-item">
      <label>預期年回報率（%）</label>
      <input type="number" id="rate" value="7" step="0.1" min="0">
    </div>
  </div>

  <div class="input-group">
    <div class="form-item">
      <label>預測時限（年）</label>
      <input type="number" id="years" value="20" min="1" max="50">
    </div>
    <div class="form-item">
      <label>每月固定投入金額（元）</label>
      <input type="number" id="monthly" value="10000" min="0">
    </div>
  </div>

  <button onclick="calculate()">開始計算</button>

  <div id="result"></div>

  <canvas id="chart" height="120"></canvas>
</div>

<script>
let myChart;

function calculate() {
  // 取得輸入值
  const initial = parseFloat(document.getElementById('initial').value) || 0;
  const annualRate = parseFloat(document.getElementById('rate').value) / 100;
  const years = parseInt(document.getElementById('years').value);
  const monthlyAdd = parseFloat(document.getElementById('monthly').value) || 0;

  const months = years * 12;
  const monthlyRate = annualRate / 12;

  // 計算每個月結束時的資產
  let balance = initial;
  const data = [{x: 0, y: Math.round(initial)}];

  for (let m = 1; m <= months; m++) {
    balance = balance * (1 + monthlyRate) + monthlyAdd;
    // 每年記錄一次（第12、24、36...個月）
    if (m % 12 === 0) {
      data.push({x: m/12, y: Math.round(balance)});
    }
  }

  const finalAmount = Math.round(balance);

  // 顯示最終金額
  document.getElementById('result').innerHTML = 
    ` ${years} 年後，預估資產將達到：<span style="color:#D32F2F;">${finalAmount.toLocaleString()} 元</span>`;

  // 繪製圖表
  const ctx = document.getElementById('chart').getContext('2d');
  
  if (myChart) myChart.destroy();

  myChart = new Chart(ctx, {
    type: 'line',
    data: {
      datasets: [{
        label: '資產成長曲線',
        data: data,
        borderColor: '#FF5722',
        backgroundColor: 'rgba(255, 87, 34, 0.2)',
        fill: true,
        tension: 0.5,
        pointRadius: 4
      }]
    },
    options: {
      responsive: true,
      plugins: {
        title: { display: true, text: '資產複利增長預測圖', font: {size: 18} },
        legend: { position: 'top'}
      },
      scales: {
        x: { title: { display: true, text: '年數（年）' } },
        y: { 
          title: { display: true, text: '資產金額（元）' },
          ticks: { callback: value => value.toLocaleString() }
        }
      }
    }
  });
}

// 頁面載入時先計算一次
window.onload = calculate;
</script>
</body>
</html>
